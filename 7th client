
import java.io.*;
import java.net.*;

public class Client {

    public static void main(String[] args) throws Exception {

        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        System.out.print("Enter Server Address: ");
        String address = br.readLine();

        Socket s = new Socket(address, 5000);
        DataInputStream din = new DataInputStream(s.getInputStream());
        DataOutputStream dout = new DataOutputStream(s.getOutputStream());

        System.out.println("Type start to receive file:");
        dout.writeUTF(br.readLine());

        String filename = din.readUTF();
        System.out.println("Receiving file: " + filename);

        long size = Long.parseLong(din.readUTF());
        System.out.println("File size: " + (size / (1024 * 1024)) + " MB");

        FileOutputStream fos = new FileOutputStream("client_" + filename);
        byte[] buffer = new byte[1024];
        int r;

        while ((r = din.read(buffer)) != -1)
            fos.write(buffer, 0, r);

        fos.close();
        s.close();
        System.out.println("Download completed.");
    }
}
